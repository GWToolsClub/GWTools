% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bw_gwqr_cv.R
\name{bw_gwqr_cv}
\alias{bw_gwqr_cv}
\title{Cross-Validation Bandwidth Selection for Geographically Weighted Quantile Regression (GWQR)}
\usage{
bw_gwqr_cv(
  formula,
  tau = 0.5,
  cordxy,
  distmethod = "euclidean",
  kernel,
  adaptive = TRUE,
  data,
  locallin = FALSE,
  bw_min = NA,
  bw_max = NA,
  parallel = TRUE,
  core = NULL
)
}
\arguments{
\item{formula}{A formula object specifying the model structure (response ~ predictors).}

\item{tau}{The quantile level to estimate. Default is 0.5 (median regression).}

\item{cordxy}{A matrix of spatial coordinates, with columns representing X and Y.}

\item{distmethod}{A character string indicating the distance calculation method to use.
Supported options are \code{"euclidean"} (default), \code{"greatcircle"} (great-circle distance), and \code{"manhattan"} (city-block distance).}

\item{kernel}{A character string specifying the kernel function used to compute spatial weights.
Options are \code{"global"}, \code{"gaussian"}, \code{"exponential"}, \code{"bisquare"}, \code{"tricube"}, and \code{"boxcar"}.}

\item{adaptive}{Logical. If \code{TRUE} (default), uses adaptive bandwidth. If \code{FALSE}, uses fixed bandwidth.}

\item{data}{A data frame containing all variables used in the model.}

\item{locallin}{Logical. If \code{TRUE}, includes local linear terms (interactions with spatial coordinates).}

\item{bw_min}{Minimum bandwidth value for the cross-validation search.
If \code{NA} (default), it is automatically set to the 10th percentile of non-zero distances (for fixed bandwidth) or 10\% of the number of observations (for adaptive bandwidth).}

\item{bw_max}{Maximum bandwidth value for the cross-validation search.
If \code{NA} (default), it is automatically set to the 90th percentile of non-zero distances (for fixed bandwidth) or 90\% of the number of observations (for adaptive bandwidth).}

\item{parallel}{Logical. If \code{TRUE} (default), enables parallel computation during the cross-validation procedure to improve speed.}

\item{core}{Integer. The number of CPU cores to use when \code{parallel = TRUE}.
If \code{NULL}, the number of cores is set to the total number of detected cores minus 2.}
}
\value{
A numeric value representing the optimal bandwidth.
}
\description{
This function selects the optimal bandwidth for a Geographically Weighted Quantile Regression (GWQR)
by minimizing the cross-validation (CV) score using a golden section search algorithm.
}
\details{
This function supports two estimation types:

\strong{1. Local Constant (default)}:
Estimates a separate set of coefficients at each location, assuming constant relationships within the local neighborhood.

\strong{2. Local Linear (set \code{locallin = TRUE})}:
Optionally includes interactions between predictors and spatial coordinates.
This allows the model to better capture spatial gradients and improve robustness near boundaries or in sparse areas.
}
\examples{
\dontrun{
data(boston, package = "spData")
boston <- boston.c
cordxy <- cbind(boston$LON, boston$LAT)

formula <- CMEDV ~ LSTAT + RM

bw <- bw_gwqr_cv(
  formula = formula, tau = 0.5,
  cordxy = cordxy, distmethod = "euclidean",
  kernel = "gaussian", adaptive = TRUE,
  data = boston, locallin = FALSE,
  parallel = TRUE, core = NULL)
bw
}
}
\references{
Chen, V. Y.-J., Deng, W.-S., Yang, T.-C., & Matthews, S. A. (2012).
Geographically weighted quantile regression (GWQR): An application to U.S. mortality data.
\emph{Geographical Analysis}, 44(2), 134â€“150.
}
