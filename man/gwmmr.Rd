% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gwmmr.R
\name{gwmmr}
\alias{gwmmr}
\title{Geographically Weighted Multivariate Multiple Regression (GWMMMR)}
\usage{
gwmmr(
  formula,
  cordxy,
  distmethod = "euclidean",
  h,
  kernel,
  adaptive = TRUE,
  data
)
}
\arguments{
\item{formula}{A formula object specifying the model structure (e.g., \code{cbind(y1, y2) ~ x1 + x2 + x3}).}

\item{cordxy}{A matrix of spatial coordinates, with columns representing X and Y.}

\item{distmethod}{A character string indicating the distance calculation method to use.
Supported options are \code{"euclidean"} (default), \code{"greatcircle"} (great-circle distance), and \code{"manhattan"} (city-block distance).}

\item{h}{The bandwidth used in the kernel function.}

\item{kernel}{A character string specifying the kernel function used to compute spatial weights.
Options are \code{"global"}, \code{"gaussian"}, \code{"exponential"}, \code{"bisquare"}, \code{"tricube"}, and \code{"boxcar"}.}

\item{adaptive}{Logical. If \code{TRUE} (default), uses adaptive bandwidth. If \code{FALSE}, uses fixed bandwidth.}

\item{data}{A data frame containing all variables used in the model.}
}
\value{
A list of class \code{"gwmmr_model"} containing:
\itemize{
\item \code{formula}: Model formula.
\item \code{test}: A data.frame with local coefficients, standard errors, fitted values, prediction errors, and multivariate test statistics.
\item \code{SSCP_E}: Residual sum of squares and cross-products matrix.
\item \code{sigmahat}: Estimated residual covariance matrix.
\item \code{epp}: Trace of the local hat matrix (S), representing the effective number of parameters across all response variables.
\item \code{epp2}: Trace of S'S, representing degrees of freedom used in estimating residual covariance.
\item \code{enp}: the effective number of parameters per response variable.
\item \code{enp2}: A bias-adjusted effective degrees of freedom used for AICc and local multivariate testing.
\item \code{df2}: Degrees of freedom used for standard error and AICc calculation.
\item \code{AIC}, \code{AICc}: Model selection criteria values.
\item \code{call}: The matched call.
}
}
\description{
This function fits a Geographically Weighted Multivariate Multiple Regression (GWMMR) model.
It provides local estimates of regression coefficients, standard errors, fitted values,
and conducts local multivariate hypothesis testing using Pillai's trace.
}
\examples{
set.seed(123)

n <- 300
x <- runif(n, 0, 100)
y <- runif(n, 0, 100)

X1 <- rnorm(n, 50, 10)
X2 <- rnorm(n, 30, 5)
X3 <- rnorm(n, mean = 10, sd = 2)

y1 <- 1.2 * X1 - 0.5 * X2 + 1.5 * X3 + rnorm(n, 0, 2)
y2 <- 0.8 * X1 + 0.3 * X2 + 1.2 * X3 + rnorm(n, 0, 2)

data <- data.frame(x = x, y = y, X1 = X1, X2 = X2, X3 = X3, y1 = y1, y2 = y2)

formula <- cbind(y1, y2) ~ X1 + X2 + X3
coords <- cbind(data$x, data$y)

gwmmr_result <- gwmmr(
  formula = formula,
  cordxy = coords,
  h = 200,
  kernel = "bisquare",
  adaptive = TRUE,
  data = data
)
gwmmr_result
}
\references{
Chen, V. Y.-J., Yang, T.-C., & Jian, H.-L. (2022).
Geographically Weighted Regression Modeling for Multiple Outcomes.
\emph{Annals of the American Association of Geographers}, 112(1), 1â€“18.
}
