% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gwqr.R
\name{gwqr}
\alias{gwqr}
\title{Geographically Weighted Quantile Regression (GWQR)}
\usage{
gwqr(
  formula,
  tau = 0.5,
  cordxy,
  distmethod = "euclidean",
  h,
  kernel,
  adaptive = TRUE,
  data,
  locallin = FALSE,
  parallel = TRUE,
  core = NULL
)
}
\arguments{
\item{formula}{A formula object specifying the model structure (response ~ predictors).}

\item{tau}{The quantile level to estimate. Default is 0.5 (median regression).}

\item{cordxy}{A matrix of spatial coordinates, with columns representing X and Y.}

\item{distmethod}{A character string indicating the distance calculation method to use.
Supported options are \code{"euclidean"} (default), \code{"greatcircle"} (great-circle distance), and \code{"manhattan"} (city-block distance).}

\item{h}{A numeric value specifying the bandwidth. This can represent a fixed distance or a number of nearest neighbors (if \code{adaptive = TRUE}).}

\item{kernel}{A character string specifying the kernel function used to compute spatial weights.
Options are \code{"global"}, \code{"gaussian"}, \code{"exponential"}, \code{"bisquare"}, \code{"tricube"}, and \code{"boxcar"}.}

\item{adaptive}{Logical. If \code{TRUE} (default), uses adaptive bandwidth. If \code{FALSE}, uses fixed bandwidth.}

\item{data}{A data frame containing all variables used in the model.}

\item{locallin}{Logical. If \code{TRUE}, includes local linear terms (interactions with spatial coordinates).}

\item{parallel}{Logical. If \code{TRUE} (default), enables parallel computation for estimation.}

\item{core}{Integer. The number of CPU cores to use when \code{parallel = TRUE}.
If \code{NULL}, the number of cores is set to the total number of detected cores minus 2.}
}
\value{
A list of class \code{"gwqr_model"} containing:
\itemize{
\item \code{formula}: The model formula.
\item \code{beta}: Matrix of local coefficient estimates.
\item \code{std}: Matrix of standard errors for each coefficient.
\item \code{tvalue}: Matrix of local t-statistics.
\item \code{muhat}: Vector of fitted values.
\item \code{error}: Vector of residuals.
\item \code{wsum}: The overall check loss.
\item \code{call}: The matched function call.
}
}
\description{
This function fits a Geographically Weighted Quantile Regression (GWQR) model
using kernel-weighted local quantile regression at each spatial location.
It supports both local constant and local linear estimation, and parallel computing for faster execution.
}
\details{
This function supports two estimation types:

\strong{1. Local Constant (default)}:
Estimates a separate set of coefficients at each location, assuming constant relationships within the local neighborhood.

\strong{2. Local Linear (set \code{locallin = TRUE})}:
Optionally includes interactions between predictors and spatial coordinates.
This allows the model to better capture spatial gradients and improve robustness near boundaries or in sparse areas.
}
\examples{
\dontrun{
data(boston, package = "spData")
boston <- boston.c
cordxy <- cbind(boston$LON, boston$LAT)

formula <- CMEDV ~ LSTAT + RM

bw <- bw_gwqr_cv(
  formula = formula, tau = 0.5,
  cordxy = cordxy, distmethod = "euclidean",
  kernel = "gaussian", adaptive = TRUE,
  data = boston, locallin = FALSE,
  parallel = TRUE, core = NULL)

result <- gwqr(
  formula = formula,
  tau = 0.5,
  cordxy = cordxy,
  distmethod = "euclidean",
  h = bw,
  kernel = "gaussian",
  adaptive = TRUE,
  data = boston,
   locallin = FALSE,
   parallel = TRUE,
   core = NULL
)
result
}
}
\references{
Chen, V. Y.-J., Deng, W.-S., Yang, T.-C., & Matthews, S. A. (2012).
Geographically weighted quantile regression (GWQR): An application to U.S. mortality data.
\emph{Geographical Analysis}, 44(2), 134â€“150.
}
