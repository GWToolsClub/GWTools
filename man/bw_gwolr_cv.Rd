% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bw_gwolr_cv.R
\name{bw_gwolr_cv}
\alias{bw_gwolr_cv}
\title{Cross-Validation Bandwidth Selection for GWOLR}
\usage{
bw_gwolr_cv(
  formula,
  cordxy,
  distmethod = "euclidean",
  kernel,
  adaptive = TRUE,
  data,
  link = "probit",
  fixed_vars = NULL,
  bw_min = NA,
  bw_max = NA,
  parallel = TRUE,
  core = NULL
)
}
\arguments{
\item{formula}{A model formula specifying the ordinal response and predictor variables.}

\item{cordxy}{A matrix of spatial coordinates, with columns representing X and Y.}

\item{distmethod}{A character string indicating the distance calculation method to use.
Supported options are \code{"euclidean"} (default), \code{"greatcircle"} (great-circle distance), and \code{"manhattan"} (city-block distance).}

\item{kernel}{A character string specifying the kernel function used to compute spatial weights.
Options are \code{"global"}, \code{"gaussian"}, \code{"exponential"}, \code{"bisquare"}, \code{"tricube"}, and \code{"boxcar"}.}

\item{adaptive}{Logical. If \code{TRUE} (default), uses adaptive bandwidth. If \code{FALSE}, uses fixed bandwidth.}

\item{data}{A data frame containing all variables used in the model.}

\item{link}{A character string specifying the link function for the ordinal logistic regression. Options are \code{"probit"} (default) and \code{"logit"}.}

\item{fixed_vars}{Optional. A character vector of predictor variable names to be treated as fixed (i.e., non-spatially varying) in the GWOLR model.
Default is \code{NULL}, in which case all predictors are treated as spatially varying.}

\item{bw_min}{Minimum bandwidth value for the cross-validation search.
If \code{NA} (default), it is automatically set to the 10th percentile of non-zero distances (for fixed bandwidth) or 10\% of the number of observations (for adaptive bandwidth).}

\item{bw_max}{Maximum bandwidth value for the cross-validation search.
If \code{NA} (default), it is automatically set to the 90th percentile of non-zero distances (for fixed bandwidth) or 90\% of the number of observations (for adaptive bandwidth).}

\item{parallel}{Logical. If \code{TRUE} (default), enables parallel computation during the cross-validation procedure to improve speed.}

\item{core}{Integer. The number of CPU cores to use when \code{parallel = TRUE}.
If \code{NULL}, the number of cores is set to the total number of detected cores minus 2.}
}
\value{
A numeric value representing the optimal bandwidth.
}
\description{
This function selects the optimal bandwidth for a Geographically Weighted Ordinal Logistic Regression (GWOLR) model using cross-validation,
based on the method proposed by Dong, Nakaya, and Brunsdon (2020). This implementation also supports parallel computing to enhance computational efficiency.
}
\details{
This function builds upon the implementation by Dong, Nakaya, and Brunsdon (2020), which uses a golden-section search to minimize leave-one-out cross-validation (CV) error.
It introduces several practical improvements and extensions over the original version:

\itemize{
\item \strong{Parallel Computing}: Supports parallel computation using the \code{parallel} package to accelerate the CV process, especially for large datasets. The number of cores can be set via \code{core}.
\item \strong{Automatic Distance Matrix Calculation}: Automatically computes the distance matrix using the provided coordinates and selected \code{distmethod}.
\item \strong{Flexible Distance Metrics}: Adds support for \code{"manhattan"} and \code{"greatcircle"} distances, in addition to the original Euclidean metric.
\item \strong{Flexible Bandwidth Ranges}: Uses a more flexible default bandwidth search range, and allows user-specified \code{bw_min} and \code{bw_max} values.
\item \strong{Expanded Kernel Options}: Supports \code{"global"}, \code{"gaussian"}, \code{"exponential"}, \code{"bisquare"}, \code{"tricube"}, and \code{"boxcar"} kernels.
}

These enhancements make the function more flexible, robust, and suitable for modern spatial modeling workflows in R.
}
\examples{
# This example is adapted from the demo script provided in the appendix of Dong et al. (2020).
\dontrun{
#if (require("gstat")){
  # Simulate spatial coordinates
  cordx<- seq(100, 199, 10)
  cordy <- seq(200, 299, 10)
  coords <- expand.grid(cordx, cordy)
  cordxy <- as.matrix(coords)
  n.total <- nrow(coords) # 100

  g.dummy <- gstat(formula = z ~ 1, locations = ~Var1 + Var2, dummy = TRUE,
                    beta = 0, model = vgm(psill = 1, model = "Exp", range = 50), nmax = 20)
  sim <- predict(g.dummy, newdata = coords, nsim = 2)

  # Generate spatially varying coefficients
  coe_x1 <- sim$sim1 - mean(sim$sim1)
  coe_x2 <- sim$sim2 - mean(sim$sim2)
  coe_mat <- cbind(coe_x1, coe_x2)

  # Generate independent variables
  X <- matrix(runif(2 * n.total, min = 1, max = 10), n.total)
  colnames(X) <- c("x1", "x2")

  # Generate latent variable and ordinal response
  eta <- rowSums(X * coe_mat) + rlogis(n.total)
  cut_points <- as.numeric(quantile(eta))
  y <- as.integer(cut(eta, breaks = cut_points, include.lowest = TRUE))

  # Assemble data
  data <- data.frame(x1 = X[, 1], x2 = X[, 2], y = factor(y))
  formula <- y ~ x1 + x2

  bw <- bw_gwolr_cv(formula = formula, cordxy = cordxy, kernel = "bisquare",
                    adaptive = FALSE, data = data,
                    link = "logit", fixed_vars = NULL,
                    parallel = TRUE, core = 4)
}
}
}
\references{
Dong, G., Nakaya, T., & Brunsdon, C. (2020). Geographically weighted regression models for ordinal categorical response variables: An application to geo-referenced life satisfaction data. \emph{Computers, Environment and Urban Systems}, 80, 101428.
}
