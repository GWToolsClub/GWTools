% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/montecarlo_gwqr.R
\name{montecarlo_gwqr}
\alias{montecarlo_gwqr}
\title{Monte Carlo Test for Spatial Variability in Geographically Weighted Quantile Regression (GWQR)}
\usage{
montecarlo_gwqr(
  formula,
  tau = 0.5,
  cordxy,
  distmethod = "euclidean",
  h,
  kernel,
  adaptive = TRUE,
  data,
  locallin = FALSE,
  n_permutations = 99,
  parallel = TRUE,
  core = NULL
)
}
\arguments{
\item{formula}{A formula object specifying the model structure (response ~ predictors).}

\item{tau}{The quantile level to estimate. Default is 0.5 (median regression).}

\item{cordxy}{A matrix of spatial coordinates, with columns representing X and Y.}

\item{distmethod}{A character string indicating the distance calculation method to use.
Supported options are \code{"euclidean"} (default), \code{"greatcircle"} (great-circle distance), and \code{"manhattan"} (city-block distance).}

\item{h}{A numeric value specifying the bandwidth. This can represent a fixed distance or a number of nearest neighbors (if \code{adaptive = TRUE}).}

\item{kernel}{A character string specifying the kernel function used to compute spatial weights.
Options are \code{"global"}, \code{"gaussian"}, \code{"exponential"}, \code{"bisquare"}, \code{"tricube"}, and \code{"boxcar"}.}

\item{adaptive}{Logical. If \code{TRUE} (default), uses adaptive bandwidth. If \code{FALSE}, uses fixed bandwidth.}

\item{data}{A data frame containing all variables used in the model.}

\item{locallin}{Logical. If \code{TRUE}, includes local linear terms (interactions with spatial coordinates).}

\item{n_permutations}{Integer. Number of Monte Carlo permutations to perform. Default is 99.}

\item{parallel}{Logical. If \code{TRUE} (default), enables parallel computation.}

\item{core}{Integer. The number of CPU cores to use when \code{parallel = TRUE}.
If \code{NULL}, the number of cores is set to the total number of detected cores minus 2.}
}
\value{
A named list with one element: \code{p_values}, a named vector of p-values for each coefficient,
indicating whether its spatial variation is statistically significant.
}
\description{
This function performs a Monte Carlo significance test for spatial variability of local coefficients in the Geographically Weighted Quantile Regression (GWQR) Model.
This implementation also supports parallel computing to enhance computational efficiency.
}
\details{
The test statistic is the spatial variance of each coefficient.
By randomly permuting spatial coordinates, the spatial structure is destroyed and a null distribution is generated.
The p-value is the proportion of permuted variances exceeding the observed variance.
}
\examples{
\dontrun{
data(boston, package = "spData")
boston <- boston.c
cordxy <- cbind(boston$LON, boston$LAT)

formula <- CMEDV ~ LSTAT + RM

bw<- bw_gwqr_cv(
  formula = formula, tau = 0.5,
  cordxy = cordxy, distmethod = "euclidean",
  kernel = "gaussian", adaptive = TRUE,
  data = boston, locallin = FALSE,
  parallel = TRUE, core = NULL)

result <- montecarlo_gwqr(
  formula = formula,
  tau = 0.5,
  cordxy = cordxy,
  distmethod = "euclidean",
  h = bw,
  kernel = "gaussian",
  adaptive = TRUE,
  data = boston,
  locallin = FALSE,
  parallel = TRUE,
  core = 3)
result
}
}
\references{
Chen, V. Y.-J., Deng, W.-S., Yang, T.-C., & Matthews, S. A. (2012).
Geographically weighted quantile regression (GWQR): An application to U.S. mortality data.
\emph{Geographical Analysis}, 44(2), 134â€“150.
}
