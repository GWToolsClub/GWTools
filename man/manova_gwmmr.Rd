% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/manova_gwmmr.R
\name{manova_gwmmr}
\alias{manova_gwmmr}
\title{Local MANOVA Test for Geographically Weighted Multivariate Multiple Regression (GWMMMR)}
\usage{
manova_gwmmr(
  formula,
  cordxy,
  distmethod = "euclidean",
  h,
  kernel,
  adaptive = TRUE,
  data,
  L,
  M,
  v
)
}
\arguments{
\item{formula}{A formula object specifying the model structure (e.g., \code{cbind(y1, y2) ~ x1 + x2 + x3}).}

\item{cordxy}{A matrix of spatial coordinates, with columns representing X and Y.}

\item{distmethod}{A character string indicating the distance calculation method to use.
Supported options are \code{"euclidean"} (default), \code{"greatcircle"} (great-circle distance), and \code{"manhattan"} (city-block distance).}

\item{h}{The bandwidth used in the kernel function.}

\item{kernel}{A character string specifying the kernel function used to compute spatial weights.
Options are \code{"global"}, \code{"gaussian"}, \code{"exponential"}, \code{"bisquare"}, \code{"tricube"}, and \code{"boxcar"}.}

\item{adaptive}{Logical. If \code{TRUE} (default), uses adaptive bandwidth. If \code{FALSE}, uses fixed bandwidth.}

\item{data}{A data frame containing all variables used in the model.}

\item{L}{A numeric matrix specifying linear constraints on the coefficient matrix \code{B}. Each row defines a linear combination to be tested.}

\item{M}{A numeric matrix specifying linear combinations among response variables.}

\item{v}{A numeric scalar representing the effective number of parameters. Use the value of \code{enp2} returned from \code{\link{gwmmr}}.}
}
\value{
A list with class \code{"gwmmr_manova"} containing:
\itemize{
\item \code{test}: A data frame with columns Pillai, Fvalue_Pillai, and P_value.
\item \code{E}: Within-group variation matrix.
\item \code{H}: Between-group variation matrix.
\item \code{df1}, \code{df2}: Local degrees of freedom used in the F-test approximation of Pillai's trace.
\item \code{call}: The matched call.
}
}
\description{
This function performs local multivariate hypothesis testing for each spatial location in a
Geographically Weighted Multivariate Multiple Regression (GWMMMR) model. It tests user-specified
linear hypotheses of the form \code{H0: LBM = C} using Pillai's trace statistic, and returns local
test results including Pillai's trace, F-statistics, and p-values at each location.
}
\details{
This function implements a localized MANOVA framework for GWMMR models, based on the multivariate general linear hypothesis (MGLH)
formulation proposed in Chen et al. (2022). At each spatial location, the function fits a local multivariate regression model and
tests the hypothesis \code{H0: L B M = C}, where \code{B} is the coefficient matrix, and \code{C} is typically assumed to be a zero matrix.
The Pillai trace statistic is computed and transformed into an approximate F distribution under multivariate normality assumptions.
}
\examples{
set.seed(123)

n <- 300
x <- runif(n, 0, 100)
y <- runif(n, 0, 100)

X1 <- rnorm(n, 50, 10)
X2 <- rnorm(n, 30, 5)
X3 <- rnorm(n, mean = 10, sd = 2)

y1 <- 1.2 * X1 - 0.5 * X2 + 1.5 * X3 + rnorm(n, 0, 2)
y2 <- 0.8 * X1 + 0.3 * X2 + 1.2 * X3 + rnorm(n, 0, 2)

data <- data.frame(x = x, y = y, X1 = X1, X2 = X2, X3 = X3, y1 = y1, y2 = y2)

formula <- cbind(y1, y2) ~ X1 + X2 + X3
coords <- cbind(data$x, data$y)

gwmmr_result <- gwmmr(
  formula = formula,
  cordxy = coords,
  h = 200,
  kernel = "bisquare",
  adaptive = TRUE,
  data = data
)

manova_result <- manova_gwmmr(
  formula = formula,
  cordxy = coords,
  h = 200,
  kernel = "bisquare",
  adaptive = TRUE,
  data = data,
  L = array(c(0,1,0,0),dim=c(1,4)),
  M = diag(2),
  v = gwmmr_result$enp
)
manova_result
}
\references{
Chen, V. Y.-J., Yang, T.-C., & Jian, H.-L. (2022).
Geographically Weighted Regression Modeling for Multiple Outcomes.
\emph{Annals of the American Association of Geographers}, 112(1), 1â€“18.
}
